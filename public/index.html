<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Whastapp Bot Machine Learning Analysis</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="container mx-auto bg-gradient-to-r from-blue-50 via-purple-50 to-pink-50 p-4 md:p-6 lg:p-9">
	<div>
		<h2 class="text-xl font-bold mb-2">Hasil Analisis Pesan</h2>
		<div id="analysis" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 md:gap-6">
		  <p>Mengambil data...</p>
		</div>
	</div>
	<div class="mt-9">
		<h2 class="text-xl font-bold mb-2">Hasil Analisis Sentimen</h2>
		<div id="sentiment" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 md:gap-6">
			<p>Mengambil data...</p>
		</div>
	</div>
	<div class="mt-9">
		<h2 class="text-xl font-bold mb-2">Analisis Sentimen Grup</h2>
		<div class="max-h-[450px] overflow-y-auto">
			<div id="sentiment-groups" class="grid grid-cols-1 md:grid-cols-2 gap-4">
				<p>Mengambil data...</p>
			</div>
		</div>
	</div>
	<div class="mt-9">
		<h2 class="text-xl font-bold mb-2">Analisis Sentimen Jenis Chat</h2>
		<div id="sentiment-chat-types" class="grid grid-cols-1 md:grid-cols-2 gap-4">
			<p>Mengambil data...</p>
		</div>
	</div>
	<div class="mt-9">
		<h2 class="text-xl font-bold mb-2">Analisis Sentimen Jenis Konten</h2>
		<div class="max-h-[450px] overflow-y-auto">
			<div id="sentiment-content-types" class="grid grid-cols-1 md:grid-cols-2 gap-4">
				<p>Mengambil data...</p>
			</div>
		</div>
	</div>
	<div class="mt-9">
		<h2 class="text-xl font-bold mb-2">Hasil Analisis per-Grup</h2>
		<div class="w-full max-h-[450px] overflow-y-auto">
			<div id="group-stats" class="w-full flex flex-col gap-2">
			  <p>Mengambil data...</p>
			</div>
		</div>
	</div>
	<div class="mt-9">
		<h2 class="text-xl font-bold mb-2">Hasil Analisis per Jenis Chat</h2>
		<div id="chat-type-stats" class="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-4">
		  <p>Mengambil data...</p>
		</div>
	</div>
	<div class="mt-9">
		<h2 class="text-xl font-bold mb-2">Hasil Analisis per Jenis Konten</h2>
		<div class="max-h-[450px] overflow-y-auto">
			<div id="type-stats" class="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-4">
			  <p>Mengambil data...</p>
			</div>
		</div>
	</div>
	<div class="mt-9">
		<h2 class="text-xl font-bold mb-2">Hasil Analisis Emosi</h2>
		<div id="emotion-stats" class="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-4">
		  <p>Mengambil data...</p>
		</div>
	</div>
	<div class="mt-9">
		<h2 class="text-xl font-bold mb-2">Hasil Analisis Niat</h2>
		<div id="intent-stats" class="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-4">
		  <p>Mengambil data...</p>
		</div>
	</div>
	<div class="mt-9">
		<h2 class="text-xl font-bold mb-2">Hasil Analisis Topik Teratas</h2>
		<div id="top-topics" class="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-4">
		  <p>Mengambil data...</p>
		</div>
	</div>
	<div class="mt-9">
		<h2 class="text-xl font-bold mb-2">Hasil Analisis Pertanyaan Teratas</h2>
		<div id="top-questions" class="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-4">
		  <p>Mengambil data...</p>
		</div>
	</div>
	<div class="mt-9">
		<h2 class="text-xl font-bold mb-2">Hasil Analisis Waktu Paling Aktif</h2>
		<div id="peak-hours" class="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-4">
		  <p>Mengambil data...</p>
		</div>
	</div>
	<div class="mt-9">
		<h2 class="text-xl font-bold mb-2">Hasil Analisis Pesan Toxic</h2>
		<div id="top-toxic-messages" class="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-4">
		  <p>Mengambil data...</p>
		</div>
	</div>
	<div class="mt-9">
		<h2 class="text-xl font-bold mb-2">Hasil Analisis Pesan Pengguna Toxic</h2>
		<div id="top-toxic-users" class="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-4">
		  <p>Mengambil data...</p>
		</div>
	</div>
	<div class="mt-9">
		<h2 class="text-xl font-bold mb-2">Hasil Analisis Pengulangan Pesan</h2>
		<div id="repeated-messages" class="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-4">
		  <p>Mengambil data...</p>
		</div>
	</div>
	<div class="mt-9">
		<h2 class="text-xl font-bold mb-2">Hasil Analisis Spam & Scam</h2>
		<div id="spam-scam-stats" class="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-4">
		  <p>Mengambil data...</p>
		</div>
	</div>
	<div class="mt-9">
		<h2 class="text-xl font-bold mb-2">Hasil Analisis Pesan Mengandung Spam & Scam</h2>
		<div id="spam-scam-messages" class="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-4">
		  <p>Mengambil data...</p>
		</div>
	</div>
	<div class="mt-9">
		<h2 class="text-xl font-bold mb-2">Hasil Analisa Teknologi Teratas</h2>
		<div id="top-technologies" class="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-4">
		  <p>Mengambil data...</p>
		</div>
	</div>
	<div class="mt-9">
		<h2 class="text-xl font-bold mb-2">Hasil Analisa Minat Teratas</h2>
		<div id="top-products" class="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-4">
		  <p>Mengambil data...</p>
		</div>
	</div>
  
  <script>
    fetch("http://localhost:3000/api/ml/analysis")
	.then(response => response.json())
	.then(data => {
		const container = document.getElementById("analysis");
        container.innerHTML = `
		  <div class="flex flex-col justify-center items-center bg-blue-500 text-white rounded-xl p-5 shadow-md hover:shadow-lg transition-all duration-300">
			<div class="text-4xl font-extrabold flex items-center gap-2">
			  <span>ğŸ’¬</span>
			  <span>${data.messagesAnalyzed}</span>
			</div>
			<span class="mt-2 text-sm tracking-wide">Jumlah Pesan</span>
		  </div>
		  <div class="flex flex-col justify-center items-center bg-indigo-500 text-white rounded-xl p-5 shadow-md hover:shadow-lg transition-all duration-300">
			<div class="text-4xl font-extrabold flex items-center gap-2">
			  <span>ğŸ¤–</span>
			  <span>${data.botMessages}</span>
			</div>
			<span class="mt-2 text-sm tracking-wide">Jumlah Pesan Bot</span>
		  </div>
		  <div class="flex flex-col justify-center items-center bg-emerald-500 text-white rounded-xl p-5 shadow-md hover:shadow-lg transition-all duration-300">
			<div class="text-4xl font-extrabold flex items-center gap-2">
			  <span>ğŸ“</span>
			  <span>${data.avgWordsPerMessage}</span>
			</div>
			<span class="mt-2 text-sm tracking-wide">Rata-rata Kata</span>
		  </div>
		  <div class="flex flex-col justify-center items-center bg-amber-500 text-white rounded-xl p-5 shadow-md hover:shadow-lg transition-all duration-300">
			<div class="text-4xl font-extrabold flex items-center gap-2">
			  <span>ğŸ” </span>
			  <span>${data.avgCharsPerMessage}</span>
			</div>
			<span class="mt-2 text-sm tracking-wide">Rata-rata Karakter</span>
		  </div>
		`;
	})
	.catch(error => {
        const container = document.getElementById("analysis");
        container.innerHTML = `<p class="text-red-500">Gagal mengambil data: ${error.message}</p>`;
        console.error("Terjadi kesalahan saat mengambil data:", error);
	});
	  
	fetch("http://localhost:3000/api/ml/analysis")
	.then(response => response.json())
	.then(data => {
		const stats = data.sentimentStats;
		const sentimentContainer = document.getElementById("sentiment");
		sentimentContainer.innerHTML = `
		  <div class="flex flex-col items-center justify-center bg-green-500 text-white rounded-xl p-5 shadow-md hover:shadow-lg transition duration-300">
			<div class="text-4xl font-extrabold flex items-center gap-2">
			  <span>ğŸ˜Š</span>
			  <span>${stats.positive}</span>
			</div>
			<span class="mt-2 text-sm tracking-wide">Sentimen Positif</span>
		  </div>
		  <div class="flex flex-col items-center justify-center bg-gray-500 text-white rounded-xl p-5 shadow-md hover:shadow-lg transition duration-300">
			<div class="text-4xl font-extrabold flex items-center gap-2">
			  <span>ğŸ˜</span>
			  <span>${stats.neutral}</span>
			</div>
			<span class="mt-2 text-sm tracking-wide">Sentimen Netral</span>
		  </div>
		  <div class="flex flex-col items-center justify-center bg-red-500 text-white rounded-xl p-5 shadow-md hover:shadow-lg transition duration-300">
			<div class="text-4xl font-extrabold flex items-center gap-2">
			  <span>ğŸ˜ </span>
			  <span>${stats.negative}</span>
			</div>
			<span class="mt-2 text-sm tracking-wide">Sentimen Negatif</span>
		  </div>
		  <div class="flex flex-col items-center justify-center bg-yellow-500 text-white rounded-xl p-5 shadow-md hover:shadow-lg transition duration-300">
			<div class="text-4xl font-extrabold flex items-center gap-2">
			  <span>â“</span>
			  <span>${stats.unrecognized}</span>
			</div>
			<span class="mt-2 text-sm tracking-wide">Tidak Dikenali</span>
		  </div>
		`;
	})
	.catch(error => {
		const sentimentContainer = document.getElementById("sentiment");
		sentimentContainer.innerHTML = `<p class="text-red-500">Gagal mengambil data sentimen: ${error.message}</p>`;
		console.error("Kesalahan saat mengambil data sentimen:", error);
	});

	fetch("http://localhost:3000/api/ml/analysis")
	.then(response => response.json())
	.then(data => {
		const container = document.getElementById("sentiment-groups");
		const groups = data.sentimentByGroup;
		container.innerHTML = ''; // clear loading

		for (const group in groups) {
		  const stats = groups[group];
		  const groupCard = `
			<div class="bg-white shadow-md rounded-2xl p-6">
			  <h3 class="text-lg font-bold mb-5 text-gray-800 tracking-tight">${group}</h3>
			  <div class="grid grid-cols-2 md:grid-cols-4 gap-6">
				<div class="flex flex-col items-center gap-2 hover:scale-[1.03] transition-transform duration-200">
				  <div class="bg-green-100 text-green-800 w-20 h-20 rounded-full shadow-inner ring-2 ring-green-200 flex items-center justify-center text-2xl font-extrabold">
					${stats.positive}
				  </div>
				  <div class="text-sm text-green-700 font-medium flex items-center gap-1">
					<span>ğŸ˜Š</span><span>Positif</span>
				  </div>
				</div>
				<div class="flex flex-col items-center gap-2 hover:scale-[1.03] transition-transform duration-200">
				  <div class="bg-gray-100 text-gray-800 w-20 h-20 rounded-full shadow-inner ring-2 ring-gray-300 flex items-center justify-center text-2xl font-extrabold">
					${stats.neutral}
				  </div>
				  <div class="text-sm text-gray-600 font-medium flex items-center gap-1">
					<span>ğŸ˜</span><span>Netral</span>
				  </div>
				</div>
				<div class="flex flex-col items-center gap-2 hover:scale-[1.03] transition-transform duration-200">
				  <div class="bg-red-100 text-red-800 w-20 h-20 rounded-full shadow-inner ring-2 ring-red-200 flex items-center justify-center text-2xl font-extrabold">
					${stats.negative}
				  </div>
				  <div class="text-sm text-red-700 font-medium flex items-center gap-1">
					<span>ğŸ˜ </span><span>Negatif</span>
				  </div>
				</div>
				<div class="flex flex-col items-center gap-2 hover:scale-[1.03] transition-transform duration-200">
				  <div class="bg-yellow-100 text-yellow-800 w-20 h-20 rounded-full shadow-inner ring-2 ring-yellow-200 flex items-center justify-center text-2xl font-extrabold">
					${stats.unrecognized}
				  </div>
				  <div class="text-sm text-yellow-700 font-medium flex items-center gap-1 text-center">
					<span>â“</span><span>Tidak Dikenali</span>
				  </div>
				</div>
			  </div>
			</div>
		  `;
		  container.innerHTML += groupCard;
		}
	})
	.catch(error => {
		const container = document.getElementById("sentiment-groups");
		container.innerHTML = `<p class="text-red-500">Gagal mengambil data per grup: ${error.message}</p>`;
		console.error("Kesalahan ambil data per grup:", error);
	});

	fetch("http://localhost:3000/api/ml/analysis")
	.then(response => response.json())
	.then(data => {
		const container = document.getElementById("sentiment-chat-types");
		const types = data.sentimentByChatType;
		container.innerHTML = '';

		for (const type in types) {
		const stats = types[type];
		const typeCard = `
			<div class="bg-white shadow-md rounded-2xl p-6">
			  <h3 class="text-lg font-bold mb-4 text-gray-800 tracking-tight">${type}</h3>
			  <div class="grid grid-cols-2 md:grid-cols-4 gap-6">
				<div class="flex flex-col items-center gap-2 hover:scale-[1.03] transition-transform duration-200">
				  <div class="bg-green-100 text-green-800 w-20 h-20 rounded-full shadow-inner ring-2 ring-green-200 flex items-center justify-center text-2xl font-extrabold">
					${stats.positive}
				  </div>
				  <div class="text-sm text-green-700 font-medium flex items-center gap-1">
					<span>ğŸ˜Š</span><span>Positif</span>
				  </div>
				</div>
				<div class="flex flex-col items-center gap-2 hover:scale-[1.03] transition-transform duration-200">
				  <div class="bg-gray-100 text-gray-800 w-20 h-20 rounded-full shadow-inner ring-2 ring-gray-200 flex items-center justify-center text-2xl font-extrabold">
					${stats.neutral}
				  </div>
				  <div class="text-sm text-gray-600 font-medium flex items-center gap-1">
					<span>ğŸ˜</span><span>Netral</span>
				  </div>
				</div>
				<div class="flex flex-col items-center gap-2 hover:scale-[1.03] transition-transform duration-200">
				  <div class="bg-red-100 text-red-800 w-20 h-20 rounded-full shadow-inner ring-2 ring-red-200 flex items-center justify-center text-2xl font-extrabold">
					${stats.negative}
				  </div>
				  <div class="text-sm text-red-700 font-medium flex items-center gap-1">
					<span>ğŸ˜ </span><span>Negatif</span>
				  </div>
				</div>
				<div class="flex flex-col items-center gap-2 hover:scale-[1.03] transition-transform duration-200">
				  <div class="bg-yellow-100 text-yellow-800 w-20 h-20 rounded-full shadow-inner ring-2 ring-yellow-200 flex items-center justify-center text-2xl font-extrabold">
					${stats.unrecognized}
				  </div>
				  <div class="text-sm text-yellow-700 font-medium flex items-center gap-1 text-center">
					<span>â“</span><span>Tidak Dikenali</span>
				  </div>
				</div>
			  </div>
			</div>
		`;
		container.innerHTML += typeCard;
		}
	})
	.catch(error => {
		const container = document.getElementById("sentiment-chat-types");
		container.innerHTML = `<p class="text-red-500">Gagal mengambil data jenis chat: ${error.message}</p>`;
		console.error("Kesalahan ambil data jenis chat:", error);
	});

	fetch("http://localhost:3000/api/ml/analysis")
	.then(response => response.json())
	.then(data => {
		const container = document.getElementById("sentiment-content-types");
		const types = data.sentimentByType;
		container.innerHTML = '';

		for (const type in types) {
		const stats = types[type];
		const typeCard = `
			<div class="bg-white shadow-md rounded-2xl p-6">
			  <h3 class="text-lg font-bold mb-4 text-gray-800 tracking-tight">${type}</h3>
			  <div class="grid grid-cols-2 md:grid-cols-4 gap-6">
				<div class="flex flex-col items-center gap-2 hover:scale-[1.03] transition-transform duration-200">
				  <div class="bg-green-100 text-green-800 w-20 h-20 rounded-full shadow-inner ring-2 ring-green-200 flex items-center justify-center text-2xl font-extrabold">
					${stats.positive}
				  </div>
				  <div class="text-sm text-green-700 font-medium flex items-center gap-1">
					<span>ğŸ˜Š</span><span>Positif</span>
				  </div>
				</div>
				<div class="flex flex-col items-center gap-2 hover:scale-[1.03] transition-transform duration-200">
				  <div class="bg-gray-100 text-gray-800 w-20 h-20 rounded-full shadow-inner ring-2 ring-gray-200 flex items-center justify-center text-2xl font-extrabold">
					${stats.neutral}
				  </div>
				  <div class="text-sm text-gray-600 font-medium flex items-center gap-1">
					<span>ğŸ˜</span><span>Netral</span>
				  </div>
				</div>
				<div class="flex flex-col items-center gap-2 hover:scale-[1.03] transition-transform duration-200">
				  <div class="bg-red-100 text-red-800 w-20 h-20 rounded-full shadow-inner ring-2 ring-red-200 flex items-center justify-center text-2xl font-extrabold">
					${stats.negative}
				  </div>
				  <div class="text-sm text-red-700 font-medium flex items-center gap-1">
					<span>ğŸ˜ </span><span>Negatif</span>
				  </div>
				</div>
				<div class="flex flex-col items-center gap-2 hover:scale-[1.03] transition-transform duration-200">
				  <div class="bg-yellow-100 text-yellow-800 w-20 h-20 rounded-full shadow-inner ring-2 ring-yellow-200 flex items-center justify-center text-2xl font-extrabold">
					${stats.unrecognized}
				  </div>
				  <div class="text-sm text-yellow-700 font-medium flex items-center gap-1 text-center">
					<span>â“</span><span>Tidak Dikenali</span>
				  </div>
				</div>
			  </div>
			</div>
		`;
		container.innerHTML += typeCard;
		}
	})
	.catch(error => {
		const container = document.getElementById("sentiment-content-types");
		container.innerHTML = `<p class="text-red-500">Gagal mengambil data jenis konten: ${error.message}</p>`;
		console.error("Kesalahan ambil data jenis konten:", error);
	});

	fetch("http://localhost:3000/api/ml/analysis")
    .then(response => response.json())
    .then(data => {
        const container = document.getElementById("group-stats");
        let groupStatsHtml = "";

        for (const [groupName, messageCount] of Object.entries(data.groupStats)) {
            groupStatsHtml += `
				<div class="w-full flex items-center justify-between bg-white border border-gray-100 rounded-xl p-4 shadow-sm hover:shadow-md transition-all duration-200">
				  <div class="flex items-center space-x-2 text-gray-800 font-medium truncate w-full">
					<span class="text-blue-500 text-lg">ğŸ“‚</span>
					<span class="truncate w-full">${groupName.charAt(0).toUpperCase() + groupName.slice(1)}</span>
				  </div>
				  <div class="text-blue-600 font-extrabold text-lg pl-4 shrink-0">${messageCount}</div>
				</div>
            `;
        }

        container.innerHTML = groupStatsHtml;
    })
    .catch(error => {
        const container = document.getElementById("sentiment-content-types");
        container.innerHTML = `<p class="text-red-500">Gagal mengambil data: ${error.message}</p>`;
        console.error("Terjadi kesalahan saat mengambil data:", error);
    });

	fetch("http://localhost:3000/api/ml/analysis")
    .then(response => response.json())
    .then(data => {
        const container = document.getElementById("chat-type-stats");
        let groupStatsHtml = "";

        for (const [groupName, messageCount] of Object.entries(data.chatTypeStats)) {
            groupStatsHtml += `
				<div class="flex flex-col gap-3 items-center justify-center bg-gradient-to-b from-white via-blue-50 to-white rounded-2xl p-5 shadow-md hover:shadow-lg transition-all duration-300 ease-in-out">
				  <div class="h-20 w-20 flex justify-center items-center text-2xl font-extrabold bg-blue-100 text-blue-600 rounded-full ring-2 ring-blue-200 shadow-inner">
					${messageCount}
				  </div>
				  <div class="flex items-center space-x-2 text-gray-800 text-sm sm:text-base font-medium text-center truncate max-w-[160px]">
					<span class="text-blue-500">ğŸ’¬</span>
					<span>${groupName.charAt(0).toUpperCase() + groupName.slice(1)}</span>
				  </div>
				</div>
            `;
        }

        container.innerHTML = groupStatsHtml;
    })
    .catch(error => {
        const container = document.getElementById("chat-type-stats");
        container.innerHTML = `<p class="text-red-500">Gagal mengambil data: ${error.message}</p>`;
        console.error("Terjadi kesalahan saat mengambil data:", error);
    });

	fetch("http://localhost:3000/api/ml/analysis")
    .then(response => response.json())
    .then(data => {
        const container = document.getElementById("type-stats");
        let groupStatsHtml = "";

        for (const [groupName, messageCount] of Object.entries(data.typeStats)) {
            groupStatsHtml += `
				<div class="flex flex-col gap-3 items-center justify-center bg-gradient-to-b from-white via-indigo-50 to-white rounded-2xl p-5 shadow-md hover:shadow-lg transition-all duration-200">
				  <div class="h-20 w-20 flex justify-center items-center text-2xl font-extrabold bg-indigo-100 text-indigo-600 rounded-full ring-2 ring-indigo-200 shadow-inner">
					${messageCount}
				  </div>
				  <div class="flex items-center space-x-2 text-gray-700 text-sm sm:text-base font-medium text-center truncate max-w-[160px]">
					<span class="text-blue-500">ğŸ’¬</span>
					<span>${groupName.charAt(0).toUpperCase() + groupName.slice(1)}</span>
				  </div>
				</div>
            `;
        }

        container.innerHTML = groupStatsHtml;
    })
    .catch(error => {
        const container = document.getElementById("type-stats");
        container.innerHTML = `<p class="text-red-500">Gagal mengambil data: ${error.message}</p>`;
        console.error("Terjadi kesalahan saat mengambil data:", error);
    });

	fetch("http://localhost:3000/api/ml/analysis")
    .then(response => response.json())
    .then(data => {
        const container = document.getElementById("emotion-stats");
        let groupStatsHtml = "";

        for (const [groupName, messageCount] of Object.entries(data.emotionStats)) {
            groupStatsHtml += `
				<div class="flex flex-col gap-3 items-center justify-center bg-gradient-to-b from-white via-violet-50 to-white rounded-2xl p-5 shadow-md hover:shadow-lg transition-all duration-300 ease-in-out">
				  <div class="h-20 w-20 flex justify-center items-center text-2xl font-extrabold bg-violet-100 text-violet-600 rounded-full ring-2 ring-violet-200 shadow-inner">
					${messageCount}
				  </div>
				  <div class="flex items-center space-x-2 text-gray-700 text-sm sm:text-base font-medium truncate max-w-[160px] text-center">
					<span class="text-blue-500">ğŸ’¬</span>
					<span>${groupName.charAt(0).toUpperCase() + groupName.slice(1)}</span>
				  </div>
				</div>
            `;
        }

        container.innerHTML = groupStatsHtml;
    })
    .catch(error => {
        const container = document.getElementById("emotion-stats");
        container.innerHTML = `<p class="text-red-500">Gagal mengambil data: ${error.message}</p>`;
        console.error("Terjadi kesalahan saat mengambil data:", error);
    });

	fetch("http://localhost:3000/api/ml/analysis")
    .then(response => response.json())
    .then(data => {
        const container = document.getElementById("intent-stats");
        let groupStatsHtml = "";

        for (const [groupName, messageCount] of Object.entries(data.intentStats)) {
		groupStatsHtml += `
		  <div class="flex justify-between items-center bg-gradient-to-r from-blue-50 to-white border border-blue-100 rounded-xl px-5 py-4 shadow-sm hover:shadow-md transition-all duration-200 mb-3">
			<div class="flex items-center space-x-3">
			  <span class="text-blue-500 text-xl">ğŸ§ </span>
			  <span class="text-gray-800 font-medium truncate max-w-[240px] sm:max-w-[320px]">
				${groupName.charAt(0).toUpperCase() + groupName.slice(1)}
			  </span>
			</div>
			<span class="bg-blue-100 text-blue-700 font-bold px-3 py-1 rounded-full text-sm shadow-inner">
			  ${messageCount}
			</span>
		  </div>
		`;
        }

        container.innerHTML = groupStatsHtml;
    })
    .catch(error => {
        const container = document.getElementById("intent-stats");
        container.innerHTML = `<p class="text-red-500">Gagal mengambil data: ${error.message}</p>`;
        console.error("Terjadi kesalahan saat mengambil data:", error);
    });

	fetch("http://localhost:3000/api/ml/analysis")
    .then(response => response.json())
    .then(data => {
        const groupContainer = document.getElementById("top-topics");
        let groupStatsHtml = "";

        for (const [groupName, messageCount] of Object.entries(data.groupStats)) {
            const formattedName = groupName.charAt(0).toUpperCase() + groupName.slice(1);
			groupStatsHtml += `
			  <div class="flex justify-between items-center bg-gradient-to-r from-blue-50 to-white border border-blue-100 rounded-xl px-5 py-4 shadow-sm hover:shadow-md transition-all duration-200 mb-3">
				<div class="flex items-center space-x-3">
				  <span class="text-blue-500 text-lg">ğŸ‘¥</span>
				  <span class="text-gray-800 font-medium truncate max-w-[200px] sm:max-w-[300px]">${formattedName}</span>
				</div>
				<span class="bg-blue-100 text-blue-700 font-bold px-3 py-1 rounded-full text-sm shadow-inner">${messageCount}</span>
			  </div>
			`;
        }

        groupContainer.innerHTML = groupStatsHtml;

        const topicsContainer = document.getElementById("top-topics");
        let topicsHtml = "";

        data.topTopics.forEach(({ topic, count }) => {
            const formattedTopic = topic
                .split(/[\s_]+/) // biar bisa handle spasi atau underscore
                .map(word => word.charAt(0).toUpperCase() + word.slice(1))
                .join(" ");

				topicsHtml += `
				  <div class="flex justify-between items-center bg-gradient-to-r from-green-50 to-white border border-green-100 rounded-xl px-5 py-4 shadow-sm hover:shadow-md transition-all duration-200 mb-3">
					<div class="flex items-center space-x-3">
					  <span class="text-green-500 text-lg">ğŸ·ï¸</span>
					  <span class="text-gray-800 font-medium truncate max-w-[200px] sm:max-w-[300px]">${formattedTopic}</span>
					</div>
					<span class="bg-green-100 text-green-700 font-bold px-3 py-1 rounded-full text-sm shadow-inner">${count}</span>
				  </div>
				`;
        });

        topicsContainer.innerHTML = topicsHtml;
    })
    .catch(error => {
        const groupContainer = document.getElementById("group-stats");
        const topicsContainer = document.getElementById("top-topics");

        groupContainer.innerHTML = `<p class="text-red-500">Gagal mengambil data: ${error.message}</p>`;
        topicsContainer.innerHTML = `<p class="text-red-500">Gagal mengambil data: ${error.message}</p>`;

        console.error("Terjadi kesalahan saat mengambil data:", error);
    });

	fetch("http://localhost:3000/api/ml/analysis")
    .then(response => response.json())
    .then(data => {
        const questionsContainer = document.getElementById("top-questions");
        let questionsHtml = "";

        data.topQuestions.forEach((question, index) => {
			questionsHtml += `
			  <div class="flex items-start bg-white border border-gray-200 rounded-xl px-5 py-4 shadow-sm hover:shadow-md transition-all duration-200 mb-3">
				<div class="text-xl mr-3 mt-1 text-blue-400">â“</div>
				<div class="flex flex-col">
				  <div class="flex items-center space-x-2 mb-1">
					<span class="text-sm font-semibold text-gray-500">#${index + 1}</span>
					<span class="text-xs bg-blue-100 text-blue-700 font-medium px-2 py-0.5 rounded-full">Pertanyaan</span>
				  </div>
				  <p class="text-gray-800 text-sm sm:text-base leading-snug">${question}</p>
				</div>
			  </div>
			`;
        });

        questionsContainer.innerHTML = questionsHtml;
    })
    .catch(error => {
        const questionsContainer = document.getElementById("top-questions");
        questionsContainer.innerHTML = `<p class="text-red-500">Gagal mengambil data: ${error.message}</p>`;
    });

	fetch("http://localhost:3000/api/ml/analysis")
    .then(response => response.json())
    .then(data => {
        const peakHoursContainer = document.getElementById("peak-hours");
        let peakHoursHtml = "";

        data.peakHours.forEach(({ hour, count }) => {
            peakHoursHtml += `
				<div class="flex justify-between items-center bg-gradient-to-br from-white via-purple-50 to-white border border-gray-100 rounded-2xl px-6 py-5 shadow-[0_4px_12px_rgba(0,0,0,0.05)] ring-1 ring-inset ring-purple-100 mb-4 hover:shadow-[0_6px_16px_rgba(139,92,246,0.25)] transition duration-300 ease-in-out">
				  <div class="flex items-center space-x-4">
					<div class="text-3xl">ğŸ•’</div>
					<div class="flex flex-col text-gray-800 text-sm sm:text-base font-medium leading-snug">
					  <span class="text-gray-500">Jam Aktif</span>
					  <span class="text-purple-700 font-semibold text-lg">${hour}:00</span>
					</div>
				  </div>
				  <div class="flex items-center bg-purple-100 text-purple-800 font-bold px-3 py-1 rounded-full text-sm shadow-inner space-x-1">
					<span>${count}</span>
					<span>ğŸ’¬</span>
				  </div>
				</div>
			`;
        });

        peakHoursContainer.innerHTML = peakHoursHtml;
    })
    .catch(error => {
        const peakHoursContainer = document.getElementById("peak-hours");
        peakHoursContainer.innerHTML = `<p class="text-red-500">Gagal mengambil data: ${error.message}</p>`;
    });

	fetch("http://localhost:3000/api/ml/analysis")
    .then(response => response.json())
    .then(data => {
        const toxicContainer = document.getElementById("top-toxic-messages");
        let toxicHtml = "";

        function stripMarkdown(md) {
			return md
				.replace(/!\[.*?\]\(.*?\)/g, '')
				.replace(/\[([^\]]+)\]\([^\)]+\)/g, '$1')
				.replace(/[*_~`>#-]/g, '')
				.replace(/\n+/g, ' ')
				.trim();
		}

		data.topToxicMessages.forEach(({ text, count }, index) => {
			const plainText = stripMarkdown(text);
			toxicHtml += `
				<div class="bg-red-100 border border-red-300 rounded-xl px-5 py-4 shadow-md mb-3 hover:shadow-lg transition-shadow duration-200">
					<div class="flex items-start justify-between">
						<div class="flex-1">
							<p class="text-red-600 font-semibold text-sm mb-1">#${index + 1}</p>
							<p class="text-gray-800 text-sm italic overflow-hidden line-clamp-2">"${plainText}"</p>
							<p class="text-xs text-gray-500 mt-2">Terdeteksi <span class="font-semibold">${count}</span> kali</p>
						</div>
					</div>
				</div>
			`;
		});

        toxicContainer.innerHTML = toxicHtml;
    })
    .catch(error => {
        const toxicContainer = document.getElementById("top-toxic-messages");
        toxicContainer.innerHTML = `<p class="text-red-500">Gagal mengambil data: ${error.message}</p>`;
    });

	fetch("http://localhost:3000/api/ml/analysis")
    .then(response => response.json())
    .then(data => {
        const toxicUsersContainer = document.getElementById("top-toxic-users");
        let toxicUsersHtml = "";

        data.topToxicUsers.forEach(({ sender, count }, index) => {
			toxicUsersHtml += `
			  <div class="flex justify-between items-center bg-yellow-100 border border-yellow-300 rounded-xl px-5 py-4 shadow-md mb-3 hover:shadow-lg transition-shadow duration-200">
				<div class="flex items-center space-x-3">
				  <div class="text-yellow-600 font-semibold text-lg">#${index + 1}</div>
				  <div class="text-yellow-800 font-medium truncate max-w-[150px] sm:max-w-[200px]">${sender}</div>
				</div>
				<div class="text-yellow-700 font-bold text-xl">${count}</div>
			  </div>
			`;
        });

        toxicUsersContainer.innerHTML = toxicUsersHtml;
    })
    .catch(error => {
        const toxicUsersContainer = document.getElementById("top-toxic-users");
        toxicUsersContainer.innerHTML = `<p class="text-red-500">Gagal mengambil data: ${error.message}</p>`;
    });

	fetch("http://localhost:3000/api/ml/analysis")
    .then(response => response.json())
    .then(data => {
        const repeatedContainer = document.getElementById("repeated-messages");
        let repeatedHtml = "";

		data.repeatedMessages.forEach(({ text, count }, index) => {
			repeatedHtml += `
				<div class="flex justify-between items-start bg-gradient-to-r from-indigo-50 to-white border-l-4 border-indigo-300 rounded-xl px-5 py-4 shadow-md hover:shadow-lg transition-all duration-200 mb-3">
					<div class="flex items-center space-x-3">
						<span class="text-indigo-500 text-xl">ğŸ’¬</span>
						<p class="text-gray-800 text-sm leading-snug max-w-xs line-clamp-2">"${text}"</p>
					</div>
					<span class="bg-indigo-100 text-indigo-700 font-bold px-3 py-1 rounded-full text-sm">${count}</span>
				</div>
			`;
		});

        repeatedContainer.innerHTML = repeatedHtml;
    })
    .catch(error => {
        const repeatedContainer = document.getElementById("repeated-messages");
        repeatedContainer.innerHTML = `<p class="text-red-500">Gagal mengambil data: ${error.message}</p>`;
    });

	fetch("http://localhost:3000/api/ml/analysis")
    .then(response => response.json())
    .then(data => {
        const spamScamContainer = document.getElementById("spam-scam-stats");

        const stats = data.spamScamStats;
        let statsHtml = "";

        const labels = {
            "spam": "Spam",
            "scam": "Scam",
            "scam+spam": "Scam + Spam"
        };

        for (const [key, value] of Object.entries(stats)) {
            statsHtml += `
				<div class="flex justify-between items-center bg-gradient-to-r from-pink-50 to-white border-l-4 border-pink-300 rounded-xl px-5 py-4 shadow-md hover:shadow-lg transition-all duration-200 ease-in-out mb-3">
					<div class="flex items-center space-x-3">
						<span class="text-pink-500 text-xl">âš ï¸</span>
						<span class="text-pink-900 font-semibold tracking-wide">${labels[key]}</span>
					</div>
					<span class="bg-pink-100 text-pink-700 font-bold px-3 py-1 rounded-full text-sm">${value}</span>
				</div>
            `;
        }

        spamScamContainer.innerHTML = statsHtml;
    })
    .catch(error => {
        const spamScamContainer = document.getElementById("spam-scam-stats");
        spamScamContainer.innerHTML = `<p class="text-red-500">Gagal mengambil data: ${error.message}</p>`;
    });
	
	fetch("http://localhost:3000/api/ml/analysis")
    .then(response => response.json())
    .then(data => {
        const scamMessagesContainer = document.getElementById("spam-scam-messages");
        let scamMessagesHtml = "";

        data.spamScamMessages.forEach(({ text, type }, index) => {
            const typeColor = {
                scam: "text-red-600",
                spam: "text-yellow-600",
                "scam+spam": "text-pink-600"
            };

			scamMessagesHtml += `
				<div class="bg-gradient-to-br from-white to-red-50 border-l-4 border-red-300 rounded-xl px-5 py-4 shadow-md hover:shadow-lg transition-all duration-200 mb-3">
					<div class="flex justify-between items-start">
						<div>
							<p class="text-xs text-gray-500 mb-1">
								#${index + 1} 
								<span class="inline-block bg-red-100 text-red-600 font-semibold px-2 py-0.5 rounded-full text-[10px] tracking-wide uppercase">
									${type}
								</span>
							</p>
							<p class="text-gray-800 italic text-sm leading-relaxed line-clamp-2">"${text}"</p>
						</div>
						<span class="text-red-400 text-lg">ğŸš¨</span>
					</div>
				</div>
			`;

        });

        scamMessagesContainer.innerHTML = scamMessagesHtml;
    })
    .catch(error => {
        const scamMessagesContainer = document.getElementById("spam-scam-messages");
        scamMessagesContainer.innerHTML = `<p class="text-red-500">Gagal mengambil data: ${error.message}</p>`;
    });

	fetch("http://localhost:3000/api/ml/analysis")
    .then(response => response.json())
    .then(data => {
        const techContainer = document.getElementById("top-technologies");
        let techHtml = "";

        data.topTechnologies.forEach(({ tech, count }) => {
            techHtml += `
                <div class="flex justify-between items-center bg-gradient-to-r from-blue-50 to-white border border-blue-200 rounded-xl px-5 py-4 shadow-md hover:shadow-lg transition-all duration-200 ease-in-out mb-3">
					<div class="flex items-center space-x-3">
						<span class="text-blue-500 text-xl">ğŸ’»</span>
						<span class="text-blue-900 font-semibold tracking-wide capitalize">${tech}</span>
					</div>
					<span class="bg-blue-100 text-blue-700 font-bold px-3 py-1 rounded-full text-sm">${count}</span>
				</div>
            `;
        });

        techContainer.innerHTML = techHtml;

        const productContainer = document.getElementById("top-products");
        let productHtml = "";

        data.topProducts.forEach(({ product, count }) => {
            productHtml += `
                <div class="flex justify-between items-center bg-gradient-to-r from-green-50 to-white border border-green-200 rounded-xl px-5 py-4 shadow-md hover:shadow-lg transition-all duration-200 ease-in-out mb-3">
					<div class="flex items-center space-x-3">
						<span class="text-green-500 text-xl">ğŸ› ï¸</span>
						<span class="text-green-900 font-semibold tracking-wide">${product}</span>
					</div>
					<span class="bg-green-100 text-green-700 font-bold px-3 py-1 rounded-full text-sm">${count}</span>
				</div>
            `;
        });

        productContainer.innerHTML = productHtml;
    })
    .catch(error => {
        document.getElementById("top-technologies").innerHTML =
            `<p class="text-red-500">Gagal mengambil data: ${error.message}</p>`;
        document.getElementById("top-products").innerHTML =
            `<p class="text-red-500">Gagal mengambil data: ${error.message}</p>`;
    });

  </script>
</body>
</html>
